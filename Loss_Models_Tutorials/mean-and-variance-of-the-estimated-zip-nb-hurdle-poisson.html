<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Loss Models Exercises</title>
  <meta name="description" content="Exercises for the students following the course Loss Models">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Loss Models Exercises" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Exercises for the students following the course Loss Models" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Loss Models Exercises" />
  
  <meta name="twitter:description" content="Exercises for the students following the course Loss Models" />
  

<meta name="author" content="Katrien Antonio and Jonas Crevecoeur">


<meta name="date" content="2018-11-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="replicating-data-sets.html">
<link rel="next" href="distributional-quantities.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
$(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
      $(this).prepend("<div class=\"showopt\">Show Solution</div><br style=\"line-height:22px;\"/>");
 
	$child = $(this).children('div');
	$child.each(function(){
		$(this).children('').attr('class', 'folded');
	});
	$(this).children('pre').attr('class', 'folded');
	$(this).children('p').attr('class', 'folded');
   });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    	$child = $(this).siblings('div');
	$child.each(function(){
		$(this).children('pre').slideToggle('fast', 'swing');
	});
	$(this).siblings('pre').slideToggle('fast', 'swing');
	$(this).siblings('p').slideToggle('fast', 'swing');
  });
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Intro</a></li>
<li class="chapter" data-level="2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html"><i class="fa fa-check"></i><b>2</b> Claim Count Distributions</a><ul>
<li class="chapter" data-level="2.1" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#read-in-data"><i class="fa fa-check"></i><b>2.1</b> Read in data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#determining-the-file-path"><i class="fa fa-check"></i><b>2.1.1</b> Determining the file path</a></li>
<li class="chapter" data-level="2.1.2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#importing-a-.txt-file"><i class="fa fa-check"></i><b>2.1.2</b> Importing a .txt file</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.2</b> Exploratory analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#summary-statistics-disregarding-exposure"><i class="fa fa-check"></i><b>2.2.1</b> Summary statistics disregarding exposure</a></li>
<li class="chapter" data-level="2.2.2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#summary-statistics-taking-into-account-exposure"><i class="fa fa-check"></i><b>2.2.2</b> Summary statistics taking into account exposure</a></li>
<li class="chapter" data-level="2.2.3" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#empirical-probability-distribution"><i class="fa fa-check"></i><b>2.2.3</b> Empirical probability distribution</a></li>
<li class="chapter" data-level="2.2.4" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#the-a-b-0-class-of-distributions"><i class="fa fa-check"></i><b>2.2.4</b> The (a, b, 0) class of distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#fitting-count-distributions"><i class="fa fa-check"></i><b>2.3</b> Fitting count distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#poisson"><i class="fa fa-check"></i><b>2.3.1</b> Poisson</a></li>
<li class="chapter" data-level="2.3.2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>2.3.2</b> Negative Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#modified-poisson-distributions"><i class="fa fa-check"></i><b>2.4</b> Modified Poisson distributions</a><ul>
<li class="chapter" data-level="2.4.1" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#zero-inflated-poisson-zip"><i class="fa fa-check"></i><b>2.4.1</b> Zero Inflated Poisson (ZIP)</a></li>
<li class="chapter" data-level="2.4.2" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#hurdle-poisson"><i class="fa fa-check"></i><b>2.4.2</b> Hurdle Poisson</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="claim-count-distributions.html"><a href="claim-count-distributions.html#aic"><i class="fa fa-check"></i><b>2.5</b> AIC</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="replicating-data-sets.html"><a href="replicating-data-sets.html"><i class="fa fa-check"></i><b>3</b> Replicating data sets</a><ul>
<li class="chapter" data-level="3.1" data-path="replicating-data-sets.html"><a href="replicating-data-sets.html#poisson-1"><i class="fa fa-check"></i><b>3.1</b> Poisson</a></li>
<li class="chapter" data-level="3.2" data-path="replicating-data-sets.html"><a href="replicating-data-sets.html#nb"><i class="fa fa-check"></i><b>3.2</b> NB</a></li>
<li class="chapter" data-level="3.3" data-path="replicating-data-sets.html"><a href="replicating-data-sets.html#zip"><i class="fa fa-check"></i><b>3.3</b> ZIP</a></li>
<li class="chapter" data-level="3.4" data-path="replicating-data-sets.html"><a href="replicating-data-sets.html#hurdle-poisson-1"><i class="fa fa-check"></i><b>3.4</b> Hurdle Poisson</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><i class="fa fa-check"></i><b>4</b> Mean and variance of the estimated ZIP, NB, Hurdle Poisson</a><ul>
<li class="chapter" data-level="4.1" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html#poisson-2"><i class="fa fa-check"></i><b>4.1</b> Poisson</a></li>
<li class="chapter" data-level="4.2" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html#nb-1"><i class="fa fa-check"></i><b>4.2</b> NB</a></li>
<li class="chapter" data-level="4.3" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html#zip-1"><i class="fa fa-check"></i><b>4.3</b> ZIP</a></li>
<li class="chapter" data-level="4.4" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html#hurdle-poisson-2"><i class="fa fa-check"></i><b>4.4</b> Hurdle Poisson</a></li>
<li class="chapter" data-level="4.5" data-path="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html"><a href="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson.html#comparison-with-empirical-mean-and-variance"><i class="fa fa-check"></i><b>4.5</b> Comparison with empirical mean and variance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distributional-quantities.html"><a href="distributional-quantities.html"><i class="fa fa-check"></i><b>5</b> Distributional Quantities</a><ul>
<li class="chapter" data-level="5.1" data-path="distributional-quantities.html"><a href="distributional-quantities.html#explorting-the-exponential-distribution"><i class="fa fa-check"></i><b>5.1</b> Explorting the exponential distribution</a></li>
<li class="chapter" data-level="5.2" data-path="distributional-quantities.html"><a href="distributional-quantities.html#visualizing-probability-distributions"><i class="fa fa-check"></i><b>5.2</b> Visualizing probability distributions</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Loss Models Exercises</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mean-and-variance-of-the-estimated-zip-nb-hurdle-poisson" class="section level1">
<h1><span class="header-section-number">4</span> Mean and variance of the estimated ZIP, NB, Hurdle Poisson</h1>
<p>We calculate the mean and variance of the estimated Poisson, NB, ZIP, and Hurdle Poisson (with exposure equal to one) and compare these with the empirical mean and variance. Try to derive the stated expressions for the mean and variance yourself as an exercise.</p>
<div id="poisson-2" class="section level2">
<h2><span class="header-section-number">4.1</span> Poisson</h2>
<p>For the Poisson distribution <span class="math inline">\(N \sim Poi(\lambda)\)</span>, the mean and the variance are both equal to <span class="math inline">\(\lambda\)</span>. This is called equidispersion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poisson.lambda</code></pre></div>
<pre><code>## [1] 0.1545611</code></pre>
</div>
<div id="nb-1" class="section level2">
<h2><span class="header-section-number">4.2</span> NB</h2>
<p>For the negative binomial distribution <span class="math inline">\(N \sim NB(a, \lambda)\)</span>, the mean equals <span class="math display">\[ E(N) = \lambda \]</span> and the variance <span class="math display">\[ \mathrm{var}(N) = \lambda + \lambda^2 / a  \]</span> exceeds the mean (overdispersion).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NB.mean &lt;-<span class="st"> </span>nb.mu
NB.mean</code></pre></div>
<pre><code>## [1] 0.154648</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NB.var &lt;-<span class="st"> </span>nb.mu <span class="op">+</span><span class="st"> </span>nb.mu<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>nb.a
NB.var</code></pre></div>
<pre><code>## [1] 0.1709641</code></pre>
</div>
<div id="zip-1" class="section level2">
<h2><span class="header-section-number">4.3</span> ZIP</h2>
<p>For the zero inflated Poisson distribution <span class="math inline">\(N \sim ZIP(p, \lambda)\)</span>, the mean equals <span class="math display">\[ E(N) = (1-p)\lambda \]</span> and the variance <span class="math display">\[ \mathrm{var}(N) = (1-p)(\lambda^2 + \lambda ) - (1-p)^2 \lambda ^2 = E(N) + \frac{p}{1-p} E(N)^2. \]</span></p>
<p>From the last expression we notice that the ZIP is overdispersed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ZIP.mean &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>ZIP.p)<span class="op">*</span>ZIP.lambda
ZIP.mean</code></pre></div>
<pre><code>## [1] 0.1546332</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ZIP.var &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>ZIP.p)<span class="op">*</span>(ZIP.lambda<span class="op">^</span><span class="dv">2</span><span class="op">+</span>ZIP.lambda) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>ZIP.p)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ZIP.lambda<span class="op">^</span><span class="dv">2</span>
ZIP.var &lt;-<span class="st"> </span>ZIP.mean <span class="op">+</span><span class="st"> </span>ZIP.p<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>ZIP.p)<span class="op">*</span>ZIP.mean<span class="op">^</span><span class="dv">2</span>
ZIP.var</code></pre></div>
<pre><code>## [1] 0.1698021</code></pre>
</div>
<div id="hurdle-poisson-2" class="section level2">
<h2><span class="header-section-number">4.4</span> Hurdle Poisson</h2>
<p>For the hurdle Poisson distribution <span class="math inline">\(N \sim \mathrm{Hurdle}(p, \lambda)\)</span>, the mean equals <span class="math display">\[ E(N) = \frac{1-p}{1-e^{-\lambda}}\lambda \]</span> and the variance <span class="math display">\[ \mathrm{var}(N) = \frac{1-p}{1-e^{-\lambda}} (\lambda^2 + \lambda) - E(N)^2 = E(N) + \frac{p-e^{-\lambda}}{1-p} E(N)^2. \]</span> From the last expression we notice that the Hurdle Poisson is overdispersed if <span class="math inline">\(p &gt; e^{-\lambda}\)</span>, or, if the probability mass at zero is larger than it would be under a regular Poisson setting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note that Hurdle.p = 1-fhurdle.p = q = P(N=0)</span>

Hurdle.mean &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Hurdle.p)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>Hurdle.lambda))<span class="op">*</span>Hurdle.lambda
Hurdle.mean</code></pre></div>
<pre><code>## [1] 0.100853</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Hurdle.var &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Hurdle.p)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>Hurdle.lambda))<span class="op">*</span>(Hurdle.lambda<span class="op">^</span><span class="dv">2</span><span class="op">+</span>Hurdle.lambda) <span class="op">-</span><span class="st"> </span>Hurdle.mean<span class="op">^</span><span class="dv">2</span>
Hurdle.var &lt;-<span class="st"> </span>Hurdle.mean <span class="op">+</span><span class="st"> </span>(Hurdle.p<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>Hurdle.lambda))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>Hurdle.p)<span class="op">*</span>Hurdle.mean<span class="op">^</span><span class="dv">2</span>
Hurdle.var</code></pre></div>
<pre><code>## [1] 0.1160245</code></pre>
</div>
<div id="comparison-with-empirical-mean-and-variance" class="section level2">
<h2><span class="header-section-number">4.5</span> Comparison with empirical mean and variance</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mean Obs&quot;</span> =<span class="st"> </span>m, <span class="st">&quot;mean Poisson&quot;</span> =<span class="st"> </span>poisson.lambda, <span class="st">&quot;mean NB&quot;</span> =<span class="st"> </span>NB.mean, <span class="st">&quot;mean ZIP&quot;</span> =<span class="st"> </span>ZIP.mean, <span class="st">&quot;mean Hurdle&quot;</span> =<span class="st"> </span>Hurdle.mean)
means</code></pre></div>
<pre><code>##     mean Obs mean Poisson      mean NB     mean ZIP  mean Hurdle 
## 1.599470e+05 1.545611e-01 1.546480e-01 1.546332e-01 1.008530e-01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">variances &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;variance Obs&quot;</span> =<span class="st"> </span>var, <span class="st">&quot;variance Poisson&quot;</span> =<span class="st"> </span>poisson.lambda, <span class="st">&quot;variance NB&quot;</span> =<span class="st"> </span>NB.var, <span class="st">&quot;variance ZIP&quot;</span> =<span class="st"> </span>ZIP.var, <span class="st">&quot;variance Hurdle&quot;</span>=Hurdle.var)
variances </code></pre></div>
<pre><code>##     variance Obs variance Poisson      variance NB     variance ZIP 
##        0.1675359        0.1545611        0.1709641        0.1698021 
##  variance Hurdle 
##        0.1160245</code></pre>
<p>The hurdle seems to be deviating most. This again reflects the poor way in which the exposure is taken into account in this setting when estimating the parameters.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="replicating-data-sets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distributional-quantities.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
